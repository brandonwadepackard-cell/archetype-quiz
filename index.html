<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Archetype Quiz V11.9</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%); min-height: 100vh; color: #e0e0e0; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; padding: 40px 20px; }
        .header h1 { font-size: 2.5em; background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .header p { color: #888; font-size: 1.1em; }
        .progress-container { background: #1e1e2e; border-radius: 10px; padding: 15px 20px; margin-bottom: 30px; }
        .progress-bar { height: 8px; background: #2a2a3e; border-radius: 4px; overflow: hidden; margin-bottom: 8px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4facfe, #00f2fe); transition: width 0.3s ease; }
        .progress-text { font-size: 0.9em; color: #888; }
        .question-card { background: #1e1e2e; border-radius: 15px; padding: 30px; margin-bottom: 20px; border: 1px solid #2a2a3e; }
        .question-section { display: inline-block; background: linear-gradient(135deg, #667eea, #764ba2); padding: 5px 15px; border-radius: 20px; font-size: 0.85em; margin-bottom: 15px; }
        .question-text { font-size: 1.3em; margin-bottom: 25px; color: #fff; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .option { background: #2a2a3e; border: 2px solid #3a3a4e; border-radius: 10px; padding: 15px 20px; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 15px; }
        .option:hover { border-color: #4facfe; background: #3a3a4e; }
        .option.selected-most { border-color: #00c853; background: rgba(0, 200, 83, 0.15); }
        .option.selected-least { border-color: #ff5252; background: rgba(255, 82, 82, 0.15); }
        .option.disabled { opacity: 0.5; pointer-events: none; }
        .option-letter { width: 32px; height: 32px; border-radius: 50%; background: #3a3a4e; display: flex; align-items: center; justify-content: center; font-weight: 600; flex-shrink: 0; }
        .option-text { flex: 1; }
        .selection-badge { font-size: 0.75em; padding: 3px 8px; border-radius: 10px; font-weight: 600; }
        .badge-most { background: #00c853; color: #000; }
        .badge-least { background: #ff5252; color: #fff; }
        .instructions { background: rgba(79, 172, 254, 0.1); border: 1px solid rgba(79, 172, 254, 0.3); border-radius: 10px; padding: 15px; margin-bottom: 20px; font-size: 0.9em; }
        .nav-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; }
        .btn { padding: 12px 30px; border-radius: 25px; border: none; cursor: pointer; font-size: 1em; font-weight: 600; transition: all 0.2s ease; }
        .btn-primary { background: linear-gradient(135deg, #4facfe, #00f2fe); color: #000; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(79, 172, 254, 0.4); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary { background: #3a3a4e; color: #fff; }
        .btn-secondary:hover { background: #4a4a5e; }
        
        /* Results Styles */
        .results-container { display: none; }
        .results-header { text-align: center; margin-bottom: 40px; }
        .results-header h2 { font-size: 2em; margin-bottom: 10px; }
        .layer-section { background: #1e1e2e; border-radius: 15px; padding: 25px; margin-bottom: 20px; border-left: 4px solid; }
        .layer-sun { border-color: #f39c12; }
        .layer-moon { border-color: #9b59b6; }
        .layer-shadow { border-color: #2c3e50; }
        .layer-title { font-size: 1.3em; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .layer-icon { font-size: 1.5em; }
        .archetype-result { background: #2a2a3e; border-radius: 10px; padding: 20px; margin-bottom: 15px; }
        .archetype-name { font-size: 1.2em; font-weight: 600; color: #4facfe; margin-bottom: 10px; }
        .archetype-detail { margin-bottom: 8px; font-size: 0.95em; }
        .archetype-detail strong { color: #fff; }
        .element-bars { margin-top: 15px; }
        .element-bar { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .element-label { width: 60px; font-size: 0.85em; }
        .element-track { flex: 1; height: 20px; background: #2a2a3e; border-radius: 10px; overflow: hidden; }
        .element-fill { height: 100%; border-radius: 10px; transition: width 0.5s ease; }
        .element-fire { background: linear-gradient(90deg, #f39c12, #e74c3c); }
        .element-water { background: linear-gradient(90deg, #3498db, #9b59b6); }
        .element-air { background: linear-gradient(90deg, #1abc9c, #16a085); }
        .element-earth { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .element-score { width: 40px; text-align: right; font-size: 0.85em; }
        
        /* PDF Button */
        .pdf-section { text-align: center; margin: 30px 0; padding: 20px; background: #1e1e2e; border-radius: 15px; }
        .pdf-ready { color: #00c853; margin-bottom: 15px; }
        
        /* Share Section */
        .share-section { background: #1e1e2e; border-radius: 15px; padding: 25px; margin-top: 20px; text-align: center; }
        .share-buttons { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; margin-top: 15px; }
        .share-btn { padding: 10px 20px; border-radius: 20px; border: none; cursor: pointer; font-size: 0.9em; transition: all 0.2s ease; }
        .share-twitter { background: #1da1f2; color: #fff; }
        .share-facebook { background: #4267b2; color: #fff; }
        .share-linkedin { background: #0077b5; color: #fff; }
        .share-copy { background: #3a3a4e; color: #fff; }
        
        /* Email Section */
        .email-section { background: #2a2a3e; border-radius: 10px; padding: 20px; margin-top: 20px; }
        .email-input { width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid #3a3a4e; background: #1e1e2e; color: #fff; font-size: 1em; margin-bottom: 10px; }
        .email-input:focus { outline: none; border-color: #4facfe; }
        
        /* Intro Screen Styles */
        .intro-section { background: #1e1e2e; border-radius: 15px; padding: 25px 30px; margin-bottom: 20px; border: 1px solid #2a2a3e; }
        .intro-section h2 { color: #4facfe; margin-bottom: 15px; font-size: 1.3em; }
        .intro-section p { margin-bottom: 12px; color: #ccc; }
        .layer-explain { display: flex; flex-direction: column; gap: 12px; margin: 20px 0; }
        .layer-item { display: flex; align-items: flex-start; gap: 15px; background: #2a2a3e; padding: 15px; border-radius: 10px; }
        .layer-item .layer-icon { font-size: 1.8em; }
        .layer-item p { margin: 5px 0 0 0; font-size: 0.9em; color: #aaa; }
        .sun-layer { border-left: 3px solid #f39c12; }
        .moon-layer { border-left: 3px solid #9b59b6; }
        .shadow-layer { border-left: 3px solid #5a6a7a; }
        .elements-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 20px 0; }
        .element-box { background: #2a2a3e; padding: 15px; border-radius: 10px; text-align: center; }
        .element-box p { margin: 5px 0 0 0; font-size: 0.85em; color: #aaa; }
        .fire-box { border-top: 3px solid #e74c3c; }
        .water-box { border-top: 3px solid #3498db; }
        .air-box { border-top: 3px solid #1abc9c; }
        .earth-box { border-top: 3px solid #27ae60; }
        .instructions-box { display: flex; flex-direction: column; gap: 12px; }
        .instruction-item { display: flex; align-items: flex-start; gap: 15px; }
        .instruction-num { background: linear-gradient(135deg, #4facfe, #00f2fe); color: #000; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0; }
        .instruction-item p { margin: 0; color: #ccc; }
        .btn-large { padding: 15px 40px; font-size: 1.1em; }
    </style>
</head>
<body>
    <div class="container">
        <!-- INTRO SCREEN -->
        <div id="intro-screen">
            <div class="header">
                <h1>The Archetype Quiz</h1>
                <p>Discover your psychological patterns across Sun, Moon & Shadow</p>
            </div>
            
            <div class="intro-section">
                <h2>What Are The Poker Archetypes?</h2>
                <p>The 16 Poker Archetypes are psychological profiles that reveal how you operate under pressure. Originally developed from thousands of hours observing behavior at high-stakes poker tables, these patterns extend far beyond cards‚Äîthey show up in your relationships, career, and life decisions.</p>
                
                <p>Every person carries <strong>three layers</strong> of archetypal energy:</p>
                
                <div class="layer-explain">
                    <div class="layer-item sun-layer">
                        <span class="layer-icon">‚òÄÔ∏è</span>
                        <div>
                            <strong>The Sun (Your Mask)</strong>
                            <p>What you want the world to see. The image you project. Your aspirational self.</p>
                        </div>
                    </div>
                    <div class="layer-item moon-layer">
                        <span class="layer-icon">üåô</span>
                        <div>
                            <strong>The Moon (Under Pressure)</strong>
                            <p>What emerges when the mask drops. Your instinctive response when stakes are high.</p>
                        </div>
                    </div>
                    <div class="layer-item shadow-layer">
                        <span class="layer-icon">üåë</span>
                        <div>
                            <strong>The Shadow (The Avoided)</strong>
                            <p>What you hide from yourself and others. Your blind spots and growth edges.</p>
                        </div>
                    </div>
                </div>
                
                <p>The archetypes are organized across four elemental energies:</p>
                
                <div class="elements-grid">
                    <div class="element-box fire-box">
                        <strong>üî• Fire</strong>
                        <p>Action, intensity, will</p>
                    </div>
                    <div class="element-box water-box">
                        <strong>üíß Water</strong>
                        <p>Connection, emotion, flow</p>
                    </div>
                    <div class="element-box air-box">
                        <strong>üí® Air</strong>
                        <p>Mind, perception, change</p>
                    </div>
                    <div class="element-box earth-box">
                        <strong>üåç Earth</strong>
                        <p>Structure, mastery, stability</p>
                    </div>
                </div>
            </div>
            
            <div class="intro-section">
                <h2>How This Quiz Works</h2>
                <div class="instructions-box">
                    <div class="instruction-item">
                        <span class="instruction-num">1</span>
                        <p><strong>45 questions</strong> across three sections (Sun, Moon, Shadow) plus direct pattern identification</p>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-num">2</span>
                        <p>For each question, select the option <strong>MOST like you</strong>, then the option <strong>LEAST like you</strong></p>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-num">3</span>
                        <p><strong>Answer honestly</strong>, not how you wish you were. The shadow questions especially require honesty to be useful.</p>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-num">4</span>
                        <p>Takes approximately <strong>12-15 minutes</strong>. Your results include a downloadable PDF report.</p>
                    </div>
                </div>
                
                <p style="text-align: center; color: #888; font-size: 0.9em; margin-top: 20px;">There are no right or wrong answers. Every archetype has gifts and shadows.</p>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary btn-large" onclick="startQuiz()">Begin The Quiz ‚Üí</button>
            </div>
        </div>
        
        <!-- QUIZ SCREEN (hidden initially) -->
        <div id="quiz-container" style="display: none;">
            <div class="header">
                <h1>The Archetype Quiz</h1>
                <p>Discover your psychological patterns across Sun, Moon & Shadow</p>
                <p style="font-size: 0.85em; color: #666; margin-top: 5px;">45 questions ¬∑ ~15 minutes ¬∑ 180 data points</p>
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <div class="progress-text">Question <span id="current-q">1</span> of 45</div>
            </div>
            
            <div class="instructions">
                <strong>Instructions:</strong> For each question, select the option that is <span style="color: #00c853;">MOST like you</span>, then the option that is <span style="color: #ff5252;">LEAST like you</span>.
            </div>
            
            <div class="question-card" id="question-card">
                <!-- Question content loaded by JS -->
            </div>
            
            <div class="nav-buttons">
                <button class="btn btn-secondary" id="back-btn" onclick="goBack()" style="display: none;">‚Üê Back</button>
                <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" disabled>Next ‚Üí</button>
            </div>
        </div>
        
        <div class="results-container" id="results-container">
            <!-- Results loaded by JS -->
        </div>
    </div>

    <script>
        // Archetype Data with deep assessment content
        const archetypeData = {
            wizard: {
                name: 'Wizard', element: 'earth',
                wound: 'Fear of being ordinary or unexceptional',
                gift: 'Sees connections others miss, strategic clarity',
                shadow: 'Uses insight as weapon, emotional detachment',
                tell: 'Eyes narrow when processing, long pauses before devastating observations',
                poker: 'Exploits patterns ruthlessly, reads timing tells',
                exploit: 'Overconfident in reads, can be manipulated by false patterns',
                growth: 'Learn that connection matters more than being right',
                blindSpots: ['Underestimates emotional intelligence in others', 'Misses when being cold pushes allies away', 'Assumes others think strategically'],
                relationships: 'Can make partners feel like specimens being studied',
                career: 'Excels in strategy, analysis, pattern recognition roles',
                lifeAdvice: 'Your mind is a gift. Don\'t let it become a prison that separates you from real human warmth.'
            },
            king: {
                name: 'King', element: 'earth',
                wound: 'Fear of being irrelevant or powerless',
                gift: 'Natural authority, vision, ability to mobilize others',
                shadow: 'Tyranny, inability to receive feedback, isolation at top',
                tell: 'Posture shifts to dominant, voice drops when authority challenged',
                poker: 'Commands table presence, influences action through sheer gravity',
                exploit: 'Challenge their authority publicly - they overreact',
                growth: 'True leadership includes vulnerability and listening',
                blindSpots: ['Confuses compliance with loyalty', 'Misses dissent brewing beneath surface', 'Believes their vision is everyone\'s vision'],
                relationships: 'Partners can feel like subjects rather than equals',
                career: 'Executive roles, entrepreneurship, any domain requiring vision',
                lifeAdvice: 'The crown is heaviest when worn alone. Let others share the weight.'
            },
            tracker: {
                name: 'Tracker', element: 'earth',
                wound: 'Fear of chaos and losing control of details',
                gift: 'Notices everything, exceptional memory, patience',
                shadow: 'Paralysis by analysis, missing forest for trees',
                tell: 'Eyes constantly scanning, cataloging, remembering',
                poker: 'Tracks every bet size, timing, pattern over sessions',
                exploit: 'Overwhelm with volume - they can\'t process chaos',
                growth: 'Trust intuition sometimes, not everything needs data',
                blindSpots: ['Misses emotional subtext while tracking facts', 'Over-indexes on historical patterns', 'Assumes past predicts future'],
                relationships: 'Can make partners feel monitored rather than loved',
                career: 'Research, analytics, investigation, quality assurance',
                lifeAdvice: 'Some things can\'t be tracked. The heart doesn\'t keep spreadsheets.'
            },
            mechanic: {
                name: 'Mechanic', element: 'earth',
                wound: 'Fear of disorder and things breaking down',
                gift: 'Builds systems that work, reliable, fixes what\'s broken',
                shadow: 'Rigidity, inability to adapt when systems fail',
                tell: 'Fidgets with objects, always optimizing something',
                poker: 'Plays systematic, exploitable by randomization',
                exploit: 'Introduce chaos - their systems can\'t handle it',
                growth: 'Sometimes broken things don\'t need fixing, they need releasing',
                blindSpots: ['Tries to systematize emotions', 'Misses that some chaos is creative', 'Fixes things that weren\'t broken'],
                relationships: 'Can treat relationship problems as engineering challenges',
                career: 'Operations, engineering, process improvement, logistics',
                lifeAdvice: 'Not everything is a machine. Some things just need to be felt.'
            },
            mirror: {
                name: 'Mirror', element: 'water',
                wound: 'Fear of being truly seen themselves',
                gift: 'Reflects truth back to others, creates self-awareness',
                shadow: 'Loses self in reflecting others, chameleon without center',
                tell: 'Unconsciously mimics others\' posture, speech patterns',
                poker: 'Excellent at reading, but gives away their reads by reacting',
                exploit: 'Show them something false - they\'ll reflect it back',
                growth: 'Develop your own center while maintaining reflective gift',
                blindSpots: ['Doesn\'t know own preferences', 'Absorbs others\' emotions as their own', 'Can\'t distinguish self from reflection'],
                relationships: 'Partners may not know the "real" them',
                career: 'Therapy, coaching, mediation, customer insight roles',
                lifeAdvice: 'You show others who they are. Now find out who YOU are.'
            },
            siren: {
                name: 'Siren', element: 'water',
                wound: 'Fear of being unlovable at core',
                gift: 'Magnetic presence, draws people in, emotional depth',
                shadow: 'Manipulation through attraction, creating dependency',
                tell: 'Draws attention without trying, energy shifts when they enter',
                poker: 'Table falls into their orbit, influences through presence not logic',
                exploit: 'Withdraw attention - they need the validation',
                growth: 'Learn that you\'re lovable without performing',
                blindSpots: ['Confuses attention with love', 'Doesn\'t see manipulation as manipulation', 'Attracts but can\'t sustain'],
                relationships: 'Intensity at start, struggles with comfortable mundane',
                career: 'Sales, performance, influence roles, brand building',
                lifeAdvice: 'You don\'t have to earn love. You just have to let it in.'
            },
            diplomat: {
                name: 'Diplomat', element: 'water',
                wound: 'Fear of conflict and disconnection',
                gift: 'Builds bridges, creates trust, finds common ground',
                shadow: 'People-pleasing, loses self in maintaining peace',
                tell: 'Speaks in "we" language, physically positions between conflicts',
                poker: 'Makes table friendly, exploited by those who use conflict strategically',
                exploit: 'Create conflict - they\'ll sacrifice position to resolve it',
                growth: 'Sometimes the bridge needs to burn',
                blindSpots: ['Enables bad behavior to keep peace', 'Doesn\'t see own needs as valid', 'Confuses peace with health'],
                relationships: 'Harmonious on surface, needs unexpressed underneath',
                career: 'HR, negotiations, partnerships, community building',
                lifeAdvice: 'Peace at any price isn\'t peace. It\'s surrender.'
            },
            hypnotist: {
                name: 'Hypnotist', element: 'air',
                wound: 'Fear of being powerless or ignored',
                gift: 'Plants ideas that take root, subtle influence mastery',
                shadow: 'Covert manipulation, making people think it was their idea',
                tell: 'Reframes constantly, seeds ideas then waits for them to "discover" it',
                poker: 'Influences opponents\' decisions through table talk, timing',
                exploit: 'Call out what they\'re doing - exposure neutralizes them',
                growth: 'Direct communication is also a form of power',
                blindSpots: ['Doesn\'t trust direct approaches', 'Assumes manipulation is always necessary', 'Loses track of own authentic desires'],
                relationships: 'Partners feel influenced but can\'t pinpoint how',
                career: 'Marketing, propaganda, persuasion arts, strategic communication',
                lifeAdvice: 'You can get what you want by asking. Try it sometime.'
            },
            oracle: {
                name: 'Oracle', element: 'air',
                wound: 'Fear of uncertainty and not knowing',
                gift: 'Sees what\'s coming, pattern recognition across time',
                shadow: 'Paralyzed by seeing too many possibilities',
                tell: 'Distant gaze, speaks in future tense, knowing smile',
                poker: 'Anticipates plays before they happen, but can be too early',
                exploit: 'Present immediate chaos - they\'re tuned to long-term',
                growth: 'Presence matters as much as foresight',
                blindSpots: ['Lives in future, misses present', 'Assumes seeing equals controlling', 'Frustrated when others don\'t see the obvious'],
                relationships: 'Can feel like talking to someone who\'s already elsewhere',
                career: 'Forecasting, strategy, risk assessment, trend analysis',
                lifeAdvice: 'Seeing the future doesn\'t mean you\'re living your life.'
            },
            trickster: {
                name: 'Trickster', element: 'air',
                wound: 'Fear of being trapped or constrained',
                gift: 'Disrupts stagnation, reveals absurdity, creates space for new',
                shadow: 'Chaos for chaos\' sake, can\'t build only destroy',
                tell: 'Gleeful at disruption, energy spikes when norms are broken',
                poker: 'Unreadable because genuinely random at times',
                exploit: 'Require consistency - they can\'t maintain it',
                growth: 'Building can be as liberating as destroying',
                blindSpots: ['Doesn\'t see value in stability', 'Confuses chaos with freedom', 'Burns bridges needed later'],
                relationships: 'Exciting but exhausting, partners crave predictability',
                career: 'Innovation, disruption roles, creative destruction',
                lifeAdvice: 'Burning it down is easy. Building something better is the real trick.'
            },
            shadow: {
                name: 'Shadow', element: 'air',
                wound: 'Fear of being exposed or truly known',
                gift: 'Persistence, operates unseen, outlasts everyone',
                shadow: 'Isolation, invisibility becomes prison',
                tell: 'Comfortable in periphery, flinches from spotlight',
                poker: 'Forgettable at table until they\'ve taken everything',
                exploit: 'Force them into spotlight - they crumble',
                growth: 'Being seen isn\'t the same as being hurt',
                blindSpots: ['Assumes invisibility is strength', 'Misses opportunities requiring visibility', 'Loneliness feels like safety'],
                relationships: 'Partners may feel they never fully know them',
                career: 'Behind-scenes roles, research, support functions',
                lifeAdvice: 'You can\'t be loved by someone who can\'t see you.'
            },
            titan: {
                name: 'Titan', element: 'fire',
                wound: 'Fear of being weak or dependent',
                gift: 'Unstoppable force, endurance, overwhelms through will',
                shadow: 'Bulldozes over nuance, doesn\'t know when to stop',
                tell: 'Leans in physically, voice gets louder when challenged',
                poker: 'Applies pressure relentlessly, exploitable by those who trap',
                exploit: 'Let them overcommit, then trap them',
                growth: 'Strength includes knowing when to yield',
                blindSpots: ['Sees yielding as weakness', 'Misses subtle resistance', 'Exhausts allies with intensity'],
                relationships: 'Partners can feel overwhelmed, steamrolled',
                career: 'Sales, athletics, any domain rewarding pure will',
                lifeAdvice: 'You\'re strong enough to be gentle. Try it.'
            },
            maniac: {
                name: 'Maniac', element: 'fire',
                wound: 'Fear of stagnation or being ordinary',
                gift: 'Lightning pattern recognition, thrives in chaos',
                shadow: 'Creates chaos to feel alive, addicted to intensity',
                tell: 'Energy accelerates rapidly, bored by stability',
                poker: 'Brilliant in wild games, self-destructs in slow ones',
                exploit: 'Slow the game down - they\'ll implode',
                growth: 'Peace isn\'t the same as death',
                blindSpots: ['Confuses calm with boring', 'Doesn\'t see self-sabotage patterns', 'Mistakes intensity for meaning'],
                relationships: 'Thrilling but chaotic, partners exhausted by rollercoaster',
                career: 'Crisis management, trading, high-variance environments',
                lifeAdvice: 'You don\'t have to set fires to feel warm.'
            },
            pirate: {
                name: 'Pirate', element: 'fire',
                wound: 'Fear of missing out or being constrained',
                gift: 'Seizes opportunity, freedom, refuses artificial limits',
                shadow: 'Can\'t commit, always looking at next horizon',
                tell: 'Eyes on exits, restless energy, light on possessions',
                poker: 'Great at short-term extraction, terrible at long games',
                exploit: 'Require commitment - they\'ll bail',
                growth: 'Some treasures require staying in one place',
                blindSpots: ['Sees commitment as trap', 'Misses value of deep relationships', 'Confuses freedom with running'],
                relationships: 'Exciting early, partners feel abandoned',
                career: 'Consulting, freelance, opportunity-driven roles',
                lifeAdvice: 'Running toward something and running from something look the same from the outside.'
            },
            alchemist: {
                name: 'Alchemist', element: 'fire',
                wound: 'Fear of worthlessness without transformation',
                gift: 'Transforms pressure into power, creates gold from lead',
                shadow: 'Addicted to crisis, creates problems to solve',
                tell: 'Comes alive in difficulty, bored by smooth sailing',
                poker: 'Best when behind, dangerous when things get hard',
                exploit: 'Don\'t give them a crisis to solve',
                growth: 'You\'re valuable without the struggle',
                blindSpots: ['Creates crises unconsciously', 'Doesn\'t recognize peace as success', 'Measures self only by transformations'],
                relationships: 'Best in hard times, struggles with contentment',
                career: 'Turnaround roles, crisis consulting, transformation work',
                lifeAdvice: 'You don\'t have to suffer to be worthy. Ease is allowed.'
            },
            knight: {
                name: 'Knight', element: 'fire',
                wound: 'Fear of betrayal or failing those who depend on them',
                gift: 'Loyalty, protection, earns devotion through dedication',
                shadow: 'Rigid loyalty, can\'t see when cause is corrupt',
                tell: 'Protective positioning, vigilance for threats to their people',
                poker: 'Plays for the group, exploitable by isolating them',
                exploit: 'Threaten their people - they\'ll make emotional mistakes',
                growth: 'Loyalty to self is not betrayal',
                blindSpots: ['Stays too long in bad situations', 'Needs a cause to feel worthy', 'Sacrifices self without being asked'],
                relationships: 'Devoted but can be suffocating in protection',
                career: 'Security, service roles, protective positions',
                lifeAdvice: 'You\'re allowed to put yourself first sometimes. It\'s not betrayal.'
            }
        };

        // Questions - MOST/LEAST format, balanced archetypes
        const questions = [
            // SUN QUESTIONS (1-11) - The Mask, what you WANT people to see
            { id: 1, type: 'sun', section: 'The Sun', text: "When meeting someone new, what do you want them to notice first?", options: [
                { text: "My confidence and directness", element: 'fire', archetypes: ['maniac', 'pirate'] },
                { text: "My warmth and approachability", element: 'water', archetypes: ['knight', 'diplomat'] },
                { text: "My insight and quick thinking", element: 'air', archetypes: ['oracle', 'shadow'] },
                { text: "My competence and reliability", element: 'earth', archetypes: ['mechanic', 'king'] }
            ]},
            { id: 2, type: 'sun', section: 'The Sun', text: "In a group project, what role do you naturally claim?", options: [
                { text: "The one who drives action forward", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "The one who keeps everyone connected", element: 'water', archetypes: ['diplomat', 'knight'] },
                { text: "The one who sees the bigger picture", element: 'air', archetypes: ['oracle', 'hypnotist'] },
                { text: "The one who ensures quality execution", element: 'earth', archetypes: ['tracker', 'wizard'] }
            ]},
            { id: 3, type: 'sun', section: 'The Sun', text: "What compliment means the most to you?", options: [
                { text: "You're fearless", element: 'fire', archetypes: ['pirate', 'alchemist'] },
                { text: "You really understand people", element: 'water', archetypes: ['knight', 'siren'] },
                { text: "You're so clever", element: 'air', archetypes: ['trickster', 'shadow'] },
                { text: "You're someone I can count on", element: 'earth', archetypes: ['king', 'tracker'] }
            ]},
            { id: 4, type: 'sun', section: 'The Sun', text: "When telling a story, what makes it good?", options: [
                { text: "The intensity and stakes", element: 'fire', archetypes: ['maniac', 'pirate'] },
                { text: "The emotional resonance", element: 'water', archetypes: ['siren', 'knight'] },
                { text: "The unexpected twist", element: 'air', archetypes: ['shadow', 'hypnotist'] },
                { text: "The clarity and precision", element: 'earth', archetypes: ['king', 'tracker'] }
            ]},
            { id: 5, type: 'sun', section: 'The Sun', text: "How do you define success?", options: [
                { text: "Winning against strong competition", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "Deep relationships and loyalty", element: 'water', archetypes: ['mirror', 'diplomat'] },
                { text: "Freedom to do things my own way", element: 'air', archetypes: ['oracle', 'shadow'] },
                { text: "Mastery and respect in my domain", element: 'earth', archetypes: ['king', 'mechanic'] }
            ]},
            { id: 6, type: 'sun', section: 'The Sun', text: "How do you prefer to solve problems?", options: [
                { text: "Face them directly with full commitment", element: 'fire', archetypes: ['titan', 'pirate'] },
                { text: "Work through the people involved", element: 'water', archetypes: ['knight', 'diplomat'] },
                { text: "Find an angle no one else sees", element: 'air', archetypes: ['trickster', 'hypnotist'] },
                { text: "Analyze systematically until the answer appears", element: 'earth', archetypes: ['wizard', 'tracker'] }
            ]},
            { id: 7, type: 'sun', section: 'The Sun', text: "What energizes you most?", options: [
                { text: "Competition and challenge", element: 'fire', archetypes: ['pirate', 'maniac'] },
                { text: "Deep conversation and connection", element: 'water', archetypes: ['mirror', 'siren'] },
                { text: "New ideas and possibilities", element: 'air', archetypes: ['oracle', 'trickster'] },
                { text: "Making progress on meaningful work", element: 'earth', archetypes: ['mechanic', 'king'] }
            ]},
            { id: 8, type: 'sun', section: 'The Sun', text: "When you walk into a room, what do you bring?", options: [
                { text: "Energy and momentum", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "Ease and warmth", element: 'water', archetypes: ['diplomat', 'siren'] },
                { text: "Curiosity and wit", element: 'air', archetypes: ['shadow', 'hypnotist'] },
                { text: "Grounding and stability", element: 'earth', archetypes: ['king', 'wizard'] }
            ]},
            { id: 9, type: 'sun', section: 'The Sun', text: "What do you want people to say about you when you're not there?", options: [
                { text: "They get things done no matter what", element: 'fire', archetypes: ['alchemist', 'pirate'] },
                { text: "They always make you feel heard", element: 'water', archetypes: ['mirror', 'knight'] },
                { text: "They see things differently than anyone else", element: 'air', archetypes: ['oracle', 'trickster'] },
                { text: "They know exactly what they're doing", element: 'earth', archetypes: ['wizard', 'mechanic'] }
            ]},
            { id: 10, type: 'sun', section: 'The Sun', text: "What's your superpower in conversation?", options: [
                { text: "I cut through the noise to what matters", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "I make people open up", element: 'water', archetypes: ['siren', 'mirror'] },
                { text: "I see what they're really saying underneath", element: 'air', archetypes: ['hypnotist', 'oracle'] },
                { text: "I remember everything and connect the dots", element: 'earth', archetypes: ['tracker', 'wizard'] }
            ]},
            { id: 11, type: 'sun', section: 'The Sun', text: "How do you want to be introduced?", options: [
                { text: "As someone who makes things happen", element: 'fire', archetypes: ['alchemist', 'maniac'] },
                { text: "As someone everyone likes", element: 'water', archetypes: ['knight', 'siren'] },
                { text: "As someone with unique perspective", element: 'air', archetypes: ['shadow', 'trickster'] },
                { text: "As someone who knows their stuff", element: 'earth', archetypes: ['king', 'mechanic'] }
            ]},
            
            // MOON QUESTIONS (12-22) - What emerges under PRESSURE
            { id: 12, type: 'moon', section: 'The Moon', text: "When blindsided by bad news, your first instinct is to:", options: [
                { text: "Take immediate action - do something", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "Reach out to someone you trust", element: 'water', archetypes: ['siren', 'knight'] },
                { text: "Step back and analyze what happened", element: 'air', archetypes: ['oracle', 'shadow'] },
                { text: "Focus on what you can control", element: 'earth', archetypes: ['mechanic', 'tracker'] }
            ]},
            { id: 13, type: 'moon', section: 'The Moon', text: "When someone attacks your character unfairly, you:", options: [
                { text: "Respond immediately and directly", element: 'fire', archetypes: ['titan', 'pirate'] },
                { text: "Feel hurt but try to understand their view", element: 'water', archetypes: ['mirror', 'diplomat'] },
                { text: "Detach and observe their motivation", element: 'air', archetypes: ['hypnotist', 'oracle'] },
                { text: "Build your case with facts and evidence", element: 'earth', archetypes: ['wizard', 'tracker'] }
            ]},
            { id: 14, type: 'moon', section: 'The Moon', text: "In a high-stakes negotiation that's going badly, you:", options: [
                { text: "Push harder and raise the stakes", element: 'fire', archetypes: ['maniac', 'alchemist'] },
                { text: "Try to rebuild rapport and find connection", element: 'water', archetypes: ['siren', 'diplomat'] },
                { text: "Look for unexpected leverage or angles", element: 'air', archetypes: ['trickster', 'hypnotist'] },
                { text: "Fall back on preparation and process", element: 'earth', archetypes: ['mechanic', 'king'] }
            ]},
            { id: 15, type: 'moon', section: 'The Moon', text: "When you fail publicly, your immediate response is:", options: [
                { text: "Get angry and channel it into action", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "Seek support from people who care about you", element: 'water', archetypes: ['knight', 'siren'] },
                { text: "Analyze what went wrong from a distance", element: 'air', archetypes: ['oracle', 'shadow'] },
                { text: "Focus on what to fix for next time", element: 'earth', archetypes: ['mechanic', 'wizard'] }
            ]},
            { id: 16, type: 'moon', section: 'The Moon', text: "When someone you trusted betrays you, you:", options: [
                { text: "Cut them off completely and move on", element: 'fire', archetypes: ['pirate', 'alchemist'] },
                { text: "Try to understand what happened between you", element: 'water', archetypes: ['mirror', 'diplomat'] },
                { text: "Watch them carefully from now on", element: 'air', archetypes: ['hypnotist', 'shadow'] },
                { text: "Adjust your trust protocols going forward", element: 'earth', archetypes: ['tracker', 'king'] }
            ]},
            { id: 17, type: 'moon', section: 'The Moon', text: "Under extreme time pressure, you:", options: [
                { text: "Move fast and trust your instincts", element: 'fire', archetypes: ['maniac', 'pirate'] },
                { text: "Lean on your team and relationships", element: 'water', archetypes: ['diplomat', 'siren'] },
                { text: "Find the one thing that matters most", element: 'air', archetypes: ['oracle', 'trickster'] },
                { text: "Execute your best-prepared process", element: 'earth', archetypes: ['mechanic', 'tracker'] }
            ]},
            { id: 18, type: 'moon', section: 'The Moon', text: "When someone is crying in front of you, you:", options: [
                { text: "Want to fix whatever caused it", element: 'fire', archetypes: ['pirate', 'titan'] },
                { text: "Sit with them and let them feel it", element: 'water', archetypes: ['mirror', 'knight'] },
                { text: "Give them space while staying present", element: 'air', archetypes: ['shadow', 'oracle'] },
                { text: "Ask questions to understand the situation", element: 'earth', archetypes: ['wizard', 'tracker'] }
            ]},
            { id: 19, type: 'moon', section: 'The Moon', text: "When you're exhausted but the work isn't done, you:", options: [
                { text: "Push through on willpower alone", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "Ask for help or share the load", element: 'water', archetypes: ['knight', 'siren'] },
                { text: "Find a smarter way that requires less effort", element: 'air', archetypes: ['trickster', 'hypnotist'] },
                { text: "Prioritize ruthlessly and cut scope", element: 'earth', archetypes: ['king', 'mechanic'] }
            ]},
            { id: 20, type: 'moon', section: 'The Moon', text: "When your idea gets rejected, you:", options: [
                { text: "Push for it harder or find another way", element: 'fire', archetypes: ['pirate', 'alchemist'] },
                { text: "Feel the disappointment and process it", element: 'water', archetypes: ['mirror', 'siren'] },
                { text: "Reframe and come at it from new angle", element: 'air', archetypes: ['hypnotist', 'trickster'] },
                { text: "Analyze the objections and refine approach", element: 'earth', archetypes: ['wizard', 'tracker'] }
            ]},
            { id: 21, type: 'moon', section: 'The Moon', text: "When plans fall apart completely, you:", options: [
                { text: "Improvise rapidly in the moment", element: 'fire', archetypes: ['maniac', 'pirate'] },
                { text: "Rally the people around you", element: 'water', archetypes: ['diplomat', 'siren'] },
                { text: "See opportunity in the chaos", element: 'air', archetypes: ['trickster', 'oracle'] },
                { text: "Fall back to first principles and rebuild", element: 'earth', archetypes: ['king', 'mechanic'] }
            ]},
            { id: 22, type: 'moon', section: 'The Moon', text: "When facing a much stronger opponent, you:", options: [
                { text: "Test them anyway - strength isn't everything", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "Look for allies and support", element: 'water', archetypes: ['diplomat', 'mirror'] },
                { text: "Find their weakness and use it", element: 'air', archetypes: ['shadow', 'hypnotist'] },
                { text: "Prepare meticulously and wait for your moment", element: 'earth', archetypes: ['wizard', 'tracker'] }
            ]},
            
            // SHADOW QUESTIONS (23-33) - What you AVOID
            { id: 23, type: 'shadow', section: 'The Shadow', text: "Which feeling do you work hardest to avoid?", options: [
                { text: "Feeling weak or helpless", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "Feeling disconnected or unloved", element: 'water', archetypes: ['knight', 'mirror'] },
                { text: "Feeling trapped or limited", element: 'air', archetypes: ['hypnotist', 'trickster'] },
                { text: "Feeling incompetent or unprepared", element: 'earth', archetypes: ['wizard', 'mechanic'] }
            ]},
            { id: 24, type: 'shadow', section: 'The Shadow', text: "What type of person triggers you most?", options: [
                { text: "People who are passive or won't fight for themselves", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "People who are cold and emotionally distant", element: 'water', archetypes: ['siren', 'diplomat'] },
                { text: "People who are rigid and closed-minded", element: 'air', archetypes: ['oracle', 'trickster'] },
                { text: "People who are sloppy and unreliable", element: 'earth', archetypes: ['tracker', 'king'] }
            ]},
            { id: 25, type: 'shadow', section: 'The Shadow', text: "What criticism cuts deepest?", options: [
                { text: "That I'm weak or ineffective", element: 'fire', archetypes: ['pirate', 'titan'] },
                { text: "That I'm uncaring or selfish", element: 'water', archetypes: ['knight', 'diplomat'] },
                { text: "That I'm boring or predictable", element: 'air', archetypes: ['shadow', 'hypnotist'] },
                { text: "That I don't know what I'm doing", element: 'earth', archetypes: ['wizard', 'mechanic'] }
            ]},
            { id: 26, type: 'shadow', section: 'The Shadow', text: "What do you secretly judge others for?", options: [
                { text: "Giving up too easily", element: 'fire', archetypes: ['pirate', 'alchemist'] },
                { text: "Being fake or inauthentic", element: 'water', archetypes: ['siren', 'mirror'] },
                { text: "Missing the obvious", element: 'air', archetypes: ['oracle', 'hypnotist'] },
                { text: "Being disorganized or lazy", element: 'earth', archetypes: ['tracker', 'king'] }
            ]},
            { id: 27, type: 'shadow', section: 'The Shadow', text: "What are you most afraid of becoming?", options: [
                { text: "Someone who doesn't matter", element: 'fire', archetypes: ['titan', 'maniac'] },
                { text: "Someone who ends up alone", element: 'water', archetypes: ['knight', 'siren'] },
                { text: "Someone ordinary and forgettable", element: 'air', archetypes: ['trickster', 'shadow'] },
                { text: "Someone who wasted their potential", element: 'earth', archetypes: ['wizard', 'mechanic'] }
            ]},
            { id: 28, type: 'shadow', section: 'The Shadow', text: "What do you rarely admit you need?", options: [
                { text: "Rest and recovery", element: 'fire', archetypes: ['maniac', 'alchemist'] },
                { text: "Validation and reassurance", element: 'water', archetypes: ['mirror', 'siren'] },
                { text: "Structure and routine", element: 'air', archetypes: ['trickster', 'oracle'] },
                { text: "Help from others", element: 'earth', archetypes: ['king', 'tracker'] }
            ]},
            { id: 29, type: 'shadow', section: 'The Shadow', text: "What do you secretly wish you had more of?", options: [
                { text: "Patience and calm", element: 'fire', archetypes: ['pirate', 'maniac'] },
                { text: "Independence and boundaries", element: 'water', archetypes: ['diplomat', 'mirror'] },
                { text: "Consistency and follow-through", element: 'air', archetypes: ['shadow', 'hypnotist'] },
                { text: "Spontaneity and flexibility", element: 'earth', archetypes: ['mechanic', 'wizard'] }
            ]},
            { id: 30, type: 'shadow', section: 'The Shadow', text: "What part of yourself do you hide from others?", options: [
                { text: "My vulnerability and fear", element: 'fire', archetypes: ['titan', 'pirate'] },
                { text: "My need for approval", element: 'water', archetypes: ['knight', 'diplomat'] },
                { text: "My loneliness and isolation", element: 'air', archetypes: ['oracle', 'shadow'] },
                { text: "My uncertainty and doubt", element: 'earth', archetypes: ['king', 'tracker'] }
            ]},
            { id: 31, type: 'shadow', section: 'The Shadow', text: "When do you feel most like an imposter?", options: [
                { text: "When I have to be vulnerable", element: 'fire', archetypes: ['alchemist', 'pirate'] },
                { text: "When I have to be assertive", element: 'water', archetypes: ['mirror', 'diplomat'] },
                { text: "When I have to commit long-term", element: 'air', archetypes: ['trickster', 'hypnotist'] },
                { text: "When I have to improvise without data", element: 'earth', archetypes: ['wizard', 'mechanic'] }
            ]},
            { id: 32, type: 'shadow', section: 'The Shadow', text: "What drains you fastest?", options: [
                { text: "Being held back or slowed down", element: 'fire', archetypes: ['titan', 'alchemist'] },
                { text: "Conflict and disconnection", element: 'water', archetypes: ['diplomat', 'mirror'] },
                { text: "Repetition and predictability", element: 'air', archetypes: ['shadow', 'oracle'] },
                { text: "Chaos and lack of clear process", element: 'earth', archetypes: ['mechanic', 'king'] }
            ]},
            { id: 33, type: 'shadow', section: 'The Shadow', text: "What's hardest for you to let go of?", options: [
                { text: "A fight I haven't won", element: 'fire', archetypes: ['alchemist', 'maniac'] },
                { text: "A relationship that's ending", element: 'water', archetypes: ['knight', 'mirror'] },
                { text: "An idea that didn't land", element: 'air', archetypes: ['hypnotist', 'trickster'] },
                { text: "A project before it's truly complete", element: 'earth', archetypes: ['tracker', 'wizard'] }
            ]},
            
            // ARCHETYPE QUESTIONS (34-45) - Direct Identification (behavioral only, no names)
            { id: 34, type: 'archetype', section: 'Core Patterns', text: "What comes most naturally to you?", options: [
                { text: "Seeing the truth beneath the surface", archetype: 'wizard' },
                { text: "Taking charge and setting direction", archetype: 'king' },
                { text: "Noticing patterns others miss", archetype: 'tracker' },
                { text: "Creating order from complexity", archetype: 'mechanic' }
            ]},
            { id: 35, type: 'archetype', section: 'Core Patterns', text: "In flow, what role do you play?", options: [
                { text: "I show people truths about themselves", archetype: 'mirror' },
                { text: "I sense what's coming before it arrives", archetype: 'oracle' },
                { text: "I change the game when others play by rules", archetype: 'trickster' },
                { text: "I persist long after others have quit", archetype: 'shadow' }
            ]},
            { id: 36, type: 'archetype', section: 'Core Patterns', text: "In conflict, what's your edge?", options: [
                { text: "Relentless determination through pure will", archetype: 'titan' },
                { text: "Rapid adaptation and high-speed reads", archetype: 'maniac' },
                { text: "Strike fast and seize what I want", archetype: 'pirate' },
                { text: "Transform the pressure into fuel", archetype: 'alchemist' }
            ]},
            { id: 37, type: 'archetype', section: 'Core Patterns', text: "How do you influence others?", options: [
                { text: "Through magnetic presence that draws them in", archetype: 'siren' },
                { text: "By planting ideas they think are their own", archetype: 'hypnotist' },
                { text: "Through transparent trust-building over time", archetype: 'diplomat' },
                { text: "By earning loyalty through unwavering dedication", archetype: 'knight' }
            ]},
            { id: 38, type: 'archetype', section: 'Core Patterns', text: "What do people underestimate about you?", options: [
                { text: "How deeply I see into their real motivations", archetype: 'wizard' },
                { text: "How much I notice and remember", archetype: 'tracker' },
                { text: "How long I can wait and watch unseen", archetype: 'shadow' },
                { text: "How quickly I can shift the entire frame", archetype: 'trickster' }
            ]},
            { id: 39, type: 'archetype', section: 'Core Patterns', text: "When things get hard, how do you win?", options: [
                { text: "Outwork and outlast everyone", archetype: 'titan' },
                { text: "Find order in the chaos faster than anyone", archetype: 'maniac' },
                { text: "Turn the difficulty itself into my advantage", archetype: 'alchemist' },
                { text: "Hold the line when everyone else breaks", archetype: 'oracle' }
            ]},
            { id: 40, type: 'archetype', section: 'Core Patterns', text: "What do you protect most fiercely?", options: [
                { text: "My sense of purpose and mission", archetype: 'king' },
                { text: "The people I'm loyal to", archetype: 'knight' },
                { text: "My craft and what I'm building", archetype: 'mechanic' },
                { text: "My freedom and independence", archetype: 'pirate' }
            ]},
            { id: 41, type: 'archetype', section: 'Core Patterns', text: "When people misread you, what happens?", options: [
                { text: "I don't explain - they'll figure it out or they won't", archetype: 'mirror' },
                { text: "I feel it deeply but don't always show it", archetype: 'siren' },
                { text: "I work to shift their perception over time", archetype: 'hypnotist' },
                { text: "I keep building bridges until we understand each other", archetype: 'diplomat' }
            ]},
            { id: 42, type: 'archetype', section: 'Core Patterns', text: "What's your relationship with rules?", options: [
                { text: "I set them for others to follow", archetype: 'king' },
                { text: "I bend them when they don't serve the goal", archetype: 'trickster' },
                { text: "I follow the ones that make sense", archetype: 'mechanic' },
                { text: "I treat them as suggestions at best", archetype: 'pirate' }
            ]},
            { id: 43, type: 'archetype', section: 'Core Patterns', text: "What matters most in close relationships?", options: [
                { text: "Being respected and recognized", archetype: 'titan' },
                { text: "Deep emotional understanding without words", archetype: 'mirror' },
                { text: "Shared insight and mental connection", archetype: 'oracle' },
                { text: "Reliability and consistent presence", archetype: 'tracker' }
            ]},
            { id: 44, type: 'archetype', section: 'Core Patterns', text: "When everything's on the line, what takes over?", options: [
                { text: "Pure instinct from somewhere deeper", archetype: 'alchemist' },
                { text: "Calm analytical precision", archetype: 'wizard' },
                { text: "Absolute commitment to what matters", archetype: 'knight' },
                { text: "Rapid improvisation until something works", archetype: 'maniac' }
            ]},
            { id: 45, type: 'archetype', section: 'Core Patterns', text: "How do you want to be remembered?", options: [
                { text: "That I changed how people think", archetype: 'hypnotist' },
                { text: "That I never gave up no matter what", archetype: 'shadow' },
                { text: "That I brought people together", archetype: 'diplomat' },
                { text: "That I made people feel truly seen", archetype: 'siren' }
            ]}
        ];

        // State
        let currentQuestion = 0;
        let answers = {};
        let generatedPdfBlob = null;
                let quizResults = null;

        // Initialize
        function init() {
            // Check for shared results in URL
            const params = new URLSearchParams(window.location.search);
            if (params.has('s')) {
                loadSharedResults(params);
            } else {
                showQuestion(0);
            }
        }

        function showQuestion(index) {
            const q = questions[index];
            const card = document.getElementById('question-card');
            const answer = answers[q.id] || { most: null, least: null };
            
            let optionsHtml = q.options.map((opt, i) => {
                const letter = String.fromCharCode(65 + i);
                let classes = 'option';
                let badge = '';
                
                if (answer.most === i) {
                    classes += ' selected-most';
                    badge = '<span class="selection-badge badge-most">MOST</span>';
                } else if (answer.least === i) {
                    classes += ' selected-least';
                    badge = '<span class="selection-badge badge-least">LEAST</span>';
                }
                
                return `
                    <div class="${classes}" onclick="selectOption(${i})" data-index="${i}">
                        <span class="option-letter">${letter}</span>
                        <span class="option-text">${opt.text}</span>
                        ${badge}
                    </div>
                `;
            }).join('');
            
            card.innerHTML = `
                <span class="question-section">${q.section}</span>
                <div class="question-text">${q.text}</div>
                <div class="options">${optionsHtml}</div>
            `;
            
            // Update progress
            document.getElementById('progress-fill').style.width = `${((index + 1) / questions.length) * 100}%`;
            document.getElementById('current-q').textContent = index + 1;
            
            // Update navigation
            document.getElementById('back-btn').style.display = index > 0 ? 'block' : 'none';
            updateNextButton();
        }

        function selectOption(index) {
            const q = questions[currentQuestion];
            if (!answers[q.id]) {
                answers[q.id] = { most: null, least: null };
            }
            
            const answer = answers[q.id];
            
            // If clicking already selected option, deselect it
            if (answer.most === index) {
                answer.most = null;
            } else if (answer.least === index) {
                answer.least = null;
            } else if (answer.most === null) {
                answer.most = index;
            } else if (answer.least === null) {
                answer.least = index;
            }
            
            showQuestion(currentQuestion);
        }

        function updateNextButton() {
            const q = questions[currentQuestion];
            const answer = answers[q.id];
            const btn = document.getElementById('next-btn');
            
            const isComplete = answer && answer.most !== null && answer.least !== null;
            btn.disabled = !isComplete;
            btn.textContent = currentQuestion === questions.length - 1 ? 'See Results' : 'Next ‚Üí';
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                calculateResults();
            }
        }

        function goBack() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function calculateResults() {
            // Initialize scores
            const elementScores = {
                sun: { fire: 0, water: 0, air: 0, earth: 0 },
                moon: { fire: 0, water: 0, air: 0, earth: 0 },
                shadow: { fire: 0, water: 0, air: 0, earth: 0 }
            };
            
            const archetypeScores = {
                sun: {},
                moon: {},
                shadow: {}
            };
            
            // Initialize all archetypes to 0
            Object.keys(archetypeData).forEach(arch => {
                archetypeScores.sun[arch] = 0;
                archetypeScores.moon[arch] = 0;
                archetypeScores.shadow[arch] = 0;
            });
            
            const directArchetypeVotes = {};
            Object.keys(archetypeData).forEach(arch => {
                directArchetypeVotes[arch] = 0;
            });
            
            // Score each answer
            questions.forEach(q => {
                const answer = answers[q.id];
                if (!answer) return;
                
                if (q.type === 'archetype') {
                    // Direct archetype selection
                    if (answer.most !== null) {
                        const arch = q.options[answer.most].archetype;
                        directArchetypeVotes[arch] += 2;
                    }
                    if (answer.least !== null) {
                        const arch = q.options[answer.least].archetype;
                        directArchetypeVotes[arch] -= 1;
                    }
                } else {
                    // Element-based questions
                    const layer = q.type;
                    
                    if (answer.most !== null) {
                        const opt = q.options[answer.most];
                        elementScores[layer][opt.element] += 4;
                        opt.archetypes.forEach(arch => {
                            archetypeScores[layer][arch] += 2;
                        });
                    }
                    
                    if (answer.least !== null) {
                        const opt = q.options[answer.least];
                        elementScores[layer][opt.element] += 1;
                        opt.archetypes.forEach(arch => {
                            archetypeScores[layer][arch] += 0.5;
                        });
                    }
                }
            });
            
            // Add direct votes to all layers proportionally
            Object.keys(directArchetypeVotes).forEach(arch => {
                const votes = directArchetypeVotes[arch];
                archetypeScores.sun[arch] += votes;
                archetypeScores.moon[arch] += votes;
                archetypeScores.shadow[arch] += votes;
            });
            
            // Find top 2 archetypes per layer
            const getTopArchetypes = (scores, n = 2) => {
                return Object.entries(scores)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, n)
                    .map(([arch, score]) => ({ archetype: arch, score }));
            };
            
            const results = {
                sun: {
                    elements: elementScores.sun,
                    topArchetypes: getTopArchetypes(archetypeScores.sun)
                },
                moon: {
                    elements: elementScores.moon,
                    topArchetypes: getTopArchetypes(archetypeScores.moon)
                },
                shadow: {
                    elements: elementScores.shadow,
                    topArchetypes: getTopArchetypes(archetypeScores.shadow)
                }
            };
            
            displayResults(results);
        }

        function displayResults(results) {
                    quizResults = results; // Store for email sending
            document.getElementById('quiz-container').style.display = 'none';
            const container = document.getElementById('results-container');
            container.style.display = 'block';
            
            const layers = [
                { key: 'sun', icon: '‚òÄÔ∏è', title: 'Your Sun (The Mask)', desc: 'What you want the world to see', color: '#f39c12' },
                { key: 'moon', icon: 'üåô', title: 'Your Moon (Under Pressure)', desc: 'What emerges when the mask drops', color: '#9b59b6' },
                { key: 'shadow', icon: 'üåë', title: 'Your Shadow (The Avoided)', desc: 'What you hide and avoid', color: '#2c3e50' }
            ];
            
            let html = `
                <div class="results-header">
                    <h2>Your Archetype Profile</h2>
                    <p>Based on 180 data points across 45 questions</p>
                </div>
            `;
            
            layers.forEach(layer => {
                const data = results[layer.key];
                const maxElement = Math.max(...Object.values(data.elements));
                
                html += `
                    <div class="layer-section layer-${layer.key}">
                        <div class="layer-title">
                            <span class="layer-icon">${layer.icon}</span>
                            <div>
                                <strong>${layer.title}</strong>
                                <div style="font-size: 0.85em; color: #888;">${layer.desc}</div>
                            </div>
                        </div>
                        
                        <div class="element-bars">
                            ${['fire', 'water', 'air', 'earth'].map(el => `
                                <div class="element-bar">
                                    <span class="element-label">${el.charAt(0).toUpperCase() + el.slice(1)}</span>
                                    <div class="element-track">
                                        <div class="element-fill element-${el}" style="width: ${(data.elements[el] / maxElement) * 100}%"></div>
                                    </div>
                                    <span class="element-score">${data.elements[el]}</span>
                                </div>
                            `).join('')}
                        </div>
                        
                        ${data.topArchetypes.map((arch, i) => {
                            const archData = archetypeData[arch.archetype];
                            let content = '';
                            
                            if (layer.key === 'sun') {
                                content = `
                                    <div class="archetype-detail"><strong>Gift:</strong> ${archData.gift}</div>
                                    <div class="archetype-detail"><strong>Blind Spots:</strong> ${archData.blindSpots.join('; ')}</div>
                                    <div class="archetype-detail"><strong>Career Fit:</strong> ${archData.career}</div>
                                `;
                            } else if (layer.key === 'moon') {
                                content = `
                                    <div class="archetype-detail"><strong>Pressure Pattern:</strong> ${archData.shadow}</div>
                                    <div class="archetype-detail"><strong>Tell:</strong> ${archData.tell}</div>
                                    <div class="archetype-detail"><strong>Exploit Vulnerability:</strong> ${archData.exploit}</div>
                                    <div class="archetype-detail"><strong>Poker Application:</strong> ${archData.poker}</div>
                                `;
                            } else {
                                content = `
                                    <div class="archetype-detail"><strong>Core Wound:</strong> ${archData.wound}</div>
                                    <div class="archetype-detail"><strong>Shadow Pattern:</strong> ${archData.shadow}</div>
                                    <div class="archetype-detail"><strong>Growth Edge:</strong> ${archData.growth}</div>
                                    <div class="archetype-detail"><strong>Relationship Impact:</strong> ${archData.relationships}</div>
                                    <div class="archetype-detail"><strong>Life Advice:</strong> ${archData.lifeAdvice}</div>
                                `;
                            }
                            
                            return `
                                <div class="archetype-result">
                                    <div class="archetype-name">${i === 0 ? 'Primary' : 'Secondary'}: The ${archData.name}</div>
                                    ${content}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            });
            
            // Generate PDF immediately
            generatePDF(results);
            
            html += `
                <div class="pdf-section">
                    <div class="pdf-ready">‚úì Your detailed PDF report is ready</div>
                    <button class="btn btn-primary" onclick="downloadPDF()">Download PDF Report</button>
                </div>
                
                <div class="share-section">
                    <h3>Share Your Results</h3>
                    <div class="share-buttons">
                        <button class="share-btn share-twitter" onclick="shareTwitter()">Twitter</button>
                        <button class="share-btn share-facebook" onclick="shareFacebook()">Facebook</button>
                        <button class="share-btn share-linkedin" onclick="shareLinkedIn()">LinkedIn</button>
                        <button class="share-btn share-copy" onclick="copyLink()">Copy Link</button>
                    </div>
                </div>
                
                <div class="email-section">
                    <h3>Get Your Results by Email</h3>
                    <input type="email" class="email-input" id="email-input" placeholder="Enter your email address">
                    <button class="btn btn-primary" onclick="sendEmail()" style="width: 100%;">Send My Results</button>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function generatePDF(results) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            let y = 20;
            const pageHeight = 280;
            const margin = 20;
            
            const checkNewPage = (needed) => {
                if (y + needed > pageHeight) {
                    doc.addPage();
                    y = 20;
                }
            };
            
            // Title
            doc.setFontSize(24);
            doc.setTextColor(79, 172, 254);
            doc.text('Your Archetype Profile', margin, y);
            y += 15;
            
            doc.setFontSize(10);
            doc.setTextColor(100);
            doc.text('Based on 180 data points across 45 questions', margin, y);
            y += 20;
            
            const layers = [
                { key: 'sun', title: 'THE SUN - Your Mask', desc: 'What you want the world to see' },
                { key: 'moon', title: 'THE MOON - Under Pressure', desc: 'What emerges when the mask drops' },
                { key: 'shadow', title: 'THE SHADOW - The Avoided', desc: 'What you hide and avoid' }
            ];
            
            layers.forEach(layer => {
                checkNewPage(80);
                
                const data = results[layer.key];
                
                // Layer header
                doc.setFontSize(16);
                doc.setTextColor(79, 172, 254);
                doc.text(layer.title, margin, y);
                y += 6;
                
                doc.setFontSize(10);
                doc.setTextColor(100);
                doc.text(layer.desc, margin, y);
                y += 12;
                
                // Element scores
                doc.setFontSize(10);
                doc.setTextColor(60);
                const elements = ['Fire', 'Water', 'Air', 'Earth'];
                elements.forEach((el, i) => {
                    const score = data.elements[el.toLowerCase()];
                    doc.text(`${el}: ${score}`, margin + (i * 40), y);
                });
                y += 12;
                
                // Archetypes
                data.topArchetypes.forEach((arch, i) => {
                    checkNewPage(60);
                    
                    const archData = archetypeData[arch.archetype];
                    
                    doc.setFontSize(12);
                    doc.setTextColor(40);
                    doc.text(`${i === 0 ? 'Primary' : 'Secondary'}: The ${archData.name}`, margin, y);
                    y += 8;
                    
                    doc.setFontSize(9);
                    doc.setTextColor(60);
                    
                    let details = [];
                    if (layer.key === 'sun') {
                        details = [
                            `Gift: ${archData.gift}`,
                            `Blind Spots: ${archData.blindSpots.join('; ')}`,
                            `Career: ${archData.career}`
                        ];
                    } else if (layer.key === 'moon') {
                        details = [
                            `Pressure Pattern: ${archData.shadow}`,
                            `Tell: ${archData.tell}`,
                            `Exploit: ${archData.exploit}`,
                            `Poker: ${archData.poker}`
                        ];
                    } else {
                        details = [
                            `Wound: ${archData.wound}`,
                            `Shadow: ${archData.shadow}`,
                            `Growth: ${archData.growth}`,
                            `Relationships: ${archData.relationships}`,
                            `Life Advice: ${archData.lifeAdvice}`
                        ];
                    }
                    
                    details.forEach(detail => {
                        const lines = doc.splitTextToSize(detail, 170);
                        lines.forEach(line => {
                            checkNewPage(6);
                            doc.text(line, margin, y);
                            y += 5;
                        });
                    });
                    
                    y += 8;
                });
                
                y += 10;
            });
            
            generatedPdfBlob = doc.output('blob');
        }

        function downloadPDF() {
            if (generatedPdfBlob) {
                const url = URL.createObjectURL(generatedPdfBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'archetype-profile.pdf';
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        function getShareUrl() {
            // Encode results into URL params
            return window.location.href.split('?')[0];
        }

        function shareTwitter() {
            const text = "I just discovered my psychological archetypes! Take the quiz:";
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(getShareUrl())}`, '_blank');
        }

        function shareFacebook() {
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(getShareUrl())}`, '_blank');
        }

        function shareLinkedIn() {
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(getShareUrl())}`, '_blank');
        }

        function copyLink() {
            navigator.clipboard.writeText(getShareUrl()).then(() => {
                alert('Link copied to clipboard!');
            });
        }

function sendEmail() {
        const email = document.getElementById('email-input').value;
        if (!email || !email.includes('@')) {
            alert('Please enter a valid email address');
            return;
        }
        
        if (!quizResults) {
            alert('No quiz results available. Please complete the quiz first.');
            return;
        }
        
        // Build form data
        const formData = new FormData();
        formData.append('email', email);
        formData.append('name', email.split('@')[0]); // Use email prefix as name
        formData.append('timestamp', new Date().toISOString());
        
        // Sun archetypes
        formData.append('sun_primary', quizResults.sun.topArchetypes[0].archetype);
        formData.append('sun_primary_score', quizResults.sun.topArchetypes[0].score);
        if (quizResults.sun.topArchetypes[1]) {
            formData.append('sun_secondary', quizResults.sun.topArchetypes[1].archetype);
            formData.append('sun_secondary_score', quizResults.sun.topArchetypes[1].score);
        }
        
        // Moon archetypes
        formData.append('moon_primary', quizResults.moon.topArchetypes[0].archetype);
        formData.append('moon_primary_score', quizResults.moon.topArchetypes[0].score);
        if (quizResults.moon.topArchetypes[1]) {
            formData.append('moon_secondary', quizResults.moon.topArchetypes[1].archetype);
            formData.append('moon_secondary_score', quizResults.moon.topArchetypes[1].score);
        }
        
        // Shadow archetypes
        formData.append('shadow_primary', quizResults.shadow.topArchetypes[0].archetype);
        formData.append('shadow_primary_score', quizResults.shadow.topArchetypes[0].score);
        if (quizResults.shadow.topArchetypes[1]) {
            formData.append('shadow_secondary', quizResults.shadow.topArchetypes[1].archetype);
            formData.append('shadow_secondary_score', quizResults.shadow.topArchetypes[1].score);
        }
        
        // Element scores
        formData.append('sun_fire', quizResults.sun.elements.fire);
        formData.append('sun_water', quizResults.sun.elements.water);
        formData.append('sun_air', quizResults.sun.elements.air);
        formData.append('sun_earth', quizResults.sun.elements.earth);
        
        formData.append('moon_fire', quizResults.moon.elements.fire);
        formData.append('moon_water', quizResults.moon.elements.water);
        formData.append('moon_air', quizResults.moon.elements.air);
        formData.append('moon_earth', quizResults.moon.elements.earth);
        
        formData.append('shadow_fire', quizResults.shadow.elements.fire);
        formData.append('shadow_water', quizResults.shadow.elements.water);
        formData.append('shadow_air', quizResults.shadow.elements.air);
        formData.append('shadow_earth', quizResults.shadow.elements.earth);
        
        // Send to Formspree
        fetch('https://formspree.io/f/xregzpog', {
            method: 'POST',
            body: formData,
            headers: {
                'Accept': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                alert('Thank you! Your results have been submitted. We\'ll send them to your email shortly.');
            } else {
                alert('Failed to send email. Please try again.');
            }
        })
        .catch(error => {
            alert('Error sending email: ' + error.message);
        });
    }
        function loadSharedResults(params) {
            // Parse shared results from URL
            // Implementation for viewing shared results
        }

        // Start the quiz
        function startQuiz() {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            showQuestion(0);
        }
        
        init();
    </script>
</body>
</html>
